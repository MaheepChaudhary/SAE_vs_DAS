
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
passed dict emned path ./dictionary_learning/dictionaries/pythia-70m-deduped/embed
  0%|                                                                 | 0/282 [00:00<?, ?it/s]You're using a GPTNeoXTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.































100%|███████████████████████████████████████████████████████| 282/282 [01:02<00:00,  4.48it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:41<00:00,  6.77it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:40<00:00,  6.99it/s]






























100%|███████████████████████████████████████████████████████| 282/282 [00:58<00:00,  4.82it/s]


















100%|███████████████████████████████████████████████████████| 282/282 [00:39<00:00,  7.21it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:38<00:00,  7.24it/s]



































100%|███████████████████████████████████████████████████████| 282/282 [01:10<00:00,  4.02it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:40<00:00,  7.04it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:39<00:00,  7.18it/s]






























100%|███████████████████████████████████████████████████████| 282/282 [01:00<00:00,  4.65it/s]




















100%|███████████████████████████████████████████████████████| 282/282 [00:41<00:00,  6.79it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:40<00:00,  6.98it/s]





























100%|███████████████████████████████████████████████████████| 282/282 [00:58<00:00,  4.83it/s]


















100%|███████████████████████████████████████████████████████| 282/282 [00:40<00:00,  6.98it/s]


















100%|███████████████████████████████████████████████████████| 282/282 [00:38<00:00,  7.29it/s]
































100%|███████████████████████████████████████████████████████| 282/282 [01:04<00:00,  4.34it/s]


















100%|███████████████████████████████████████████████████████| 282/282 [00:39<00:00,  7.11it/s]




















100%|███████████████████████████████████████████████████████| 282/282 [00:39<00:00,  7.05it/s]






























100%|███████████████████████████████████████████████████████| 282/282 [01:02<00:00,  4.48it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:39<00:00,  7.14it/s]



















100%|███████████████████████████████████████████████████████| 282/282 [00:40<00:00,  7.02it/s]































100%|███████████████████████████████████████████████████████| 282/282 [01:05<00:00,  4.32it/s]


















100%|███████████████████████████████████████████████████████| 282/282 [00:38<00:00,  7.30it/s]


 14%|███████▋                                                | 39/282 [00:05<00:31,  7.65it/s]
Traceback (most recent call last):
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 340, in <module>
    train(DEVICE=args.device,
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 135, in train
    logits, _ = new_model(text, temperature=temprature)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/atticus/maheep/SAE_vs_DAS/model.py", line 136, in forward
    with self.model.trace(text) as tracer:
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 196, in trace
    runner.invoke(*inputs, **invoker_args).__enter__()
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/contexts/Invoker.py", line 69, in __enter__
    self.tracer._model._execute(
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/mixins/Generation.py", line 21, in _execute
    return self._execute_forward(prepared_inputs, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 281, in _execute_forward
    return self._model(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 1034, in forward
    outputs = self.gpt_neox(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 925, in forward
    outputs = layer(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 691, in forward
    self.input_layernorm(hidden_states),
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 201, in forward
    return F.layer_norm(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2570, in layer_norm
    return handle_torch_function(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/overrides.py", line 1619, in handle_torch_function
    result = mode.__torch_function__(public_api, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1780, in __torch_function__
    return func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2573, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1458, in _dispatch_impl
    r = func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_ops.py", line 594, in __call__
    return self_._op(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_decomp/__init__.py", line 83, in _fn
    return f(*args, **kwargs, out=None if is_none else out_kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 252, in _fn
    result = fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_refs/__init__.py", line 3206, in native_layer_norm
    out, mean, rstd = _normalize(input, reduction_dims, eps)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_refs/__init__.py", line 3088, in _normalize
    out = (a - mean) * rstd
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 252, in _fn
    result = fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 117, in _fn
    bound = sig.bind(*args, **kwargs)
  File "/usr/lib/python3.10/inspect.py", line 3186, in bind
    return self._bind(args, kwargs)
  File "/usr/lib/python3.10/inspect.py", line 3055, in _bind
    parameters = iter(self.parameters.values())
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 340, in <module>
    train(DEVICE=args.device,
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 135, in train
    logits, _ = new_model(text, temperature=temprature)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/atticus/maheep/SAE_vs_DAS/model.py", line 136, in forward
    with self.model.trace(text) as tracer:
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 196, in trace
    runner.invoke(*inputs, **invoker_args).__enter__()
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/contexts/Invoker.py", line 69, in __enter__
    self.tracer._model._execute(
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/mixins/Generation.py", line 21, in _execute
    return self._execute_forward(prepared_inputs, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 281, in _execute_forward
    return self._model(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 1034, in forward
    outputs = self.gpt_neox(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 925, in forward
    outputs = layer(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 691, in forward
    self.input_layernorm(hidden_states),
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 201, in forward
    return F.layer_norm(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2570, in layer_norm
    return handle_torch_function(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/overrides.py", line 1619, in handle_torch_function
    result = mode.__torch_function__(public_api, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1780, in __torch_function__
    return func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/functional.py", line 2573, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1458, in _dispatch_impl
    r = func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_ops.py", line 594, in __call__
    return self_._op(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_decomp/__init__.py", line 83, in _fn
    return f(*args, **kwargs, out=None if is_none else out_kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 252, in _fn
    result = fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_refs/__init__.py", line 3206, in native_layer_norm
    out, mean, rstd = _normalize(input, reduction_dims, eps)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_refs/__init__.py", line 3088, in _normalize
    out = (a - mean) * rstd
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 252, in _fn
    result = fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_prims_common/wrappers.py", line 117, in _fn
    bound = sig.bind(*args, **kwargs)
  File "/usr/lib/python3.10/inspect.py", line 3186, in bind
    return self._bind(args, kwargs)
  File "/usr/lib/python3.10/inspect.py", line 3055, in _bind
    parameters = iter(self.parameters.values())
KeyboardInterrupt