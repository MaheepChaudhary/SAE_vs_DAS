
passed dict emned path ./dictionary_learning/dictionaries/pythia-70m-deduped/embed
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
  0%|                                              | 0/282 [00:00<?, ?it/s]You're using a GPTNeoXTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.



























100%|████████████████████████████████████| 282/282 [00:56<00:00,  5.00it/s]

















100%|████████████████████████████████████| 282/282 [00:35<00:00,  7.94it/s]
















100%|████████████████████████████████████| 282/282 [00:35<00:00,  7.91it/s]























100%|████████████████████████████████████| 282/282 [00:44<00:00,  6.37it/s]
















100%|████████████████████████████████████| 282/282 [00:35<00:00,  8.03it/s]

















100%|████████████████████████████████████| 282/282 [00:35<00:00,  7.87it/s]

























100%|████████████████████████████████████| 282/282 [00:49<00:00,  5.73it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.26it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.13it/s]


























100%|████████████████████████████████████| 282/282 [00:53<00:00,  5.31it/s]


















100%|████████████████████████████████████| 282/282 [00:36<00:00,  7.70it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.14it/s]
























100%|████████████████████████████████████| 282/282 [00:49<00:00,  5.66it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.24it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.09it/s]

























100%|████████████████████████████████████| 282/282 [00:49<00:00,  5.74it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.09it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.25it/s]



























100%|████████████████████████████████████| 282/282 [00:54<00:00,  5.20it/s]
















100%|████████████████████████████████████| 282/282 [00:33<00:00,  8.32it/s]
















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.16it/s]
























100%|████████████████████████████████████| 282/282 [00:48<00:00,  5.81it/s]
















100%|████████████████████████████████████| 282/282 [00:35<00:00,  7.98it/s]

















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.09it/s]






















100%|████████████████████████████████████| 282/282 [00:45<00:00,  6.23it/s]
















100%|████████████████████████████████████| 282/282 [00:38<00:00,  7.23it/s]

















100%|████████████████████████████████████| 282/282 [00:34<00:00,  8.12it/s]

























100%|████████████████████████████████████| 282/282 [00:49<00:00,  5.64it/s]














 84%|██████████████████████████████▏     | 236/282 [00:28<00:05,  8.34it/s]
Traceback (most recent call last):
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 340, in <module>
    train(DEVICE=args.device,
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 116, in train
    logits, _ = new_model(text, temperature=temprature)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/atticus/maheep/SAE_vs_DAS/model.py", line 136, in forward
    with self.model.trace(text) as tracer:
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 196, in trace
    runner.invoke(*inputs, **invoker_args).__enter__()
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/contexts/Invoker.py", line 69, in __enter__
    self.tracer._model._execute(
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/mixins/Generation.py", line 21, in _execute
    return self._execute_forward(prepared_inputs, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 281, in _execute_forward
    return self._model(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 1034, in forward
    outputs = self.gpt_neox(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 925, in forward
    outputs = layer(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 690, in forward
    attention_layer_outputs = self.attention(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 200, in forward
    query, key = apply_rotary_pos_emb(query_rot, key_rot, cos, sin, position_ids)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 642, in apply_rotary_pos_emb
    cos = cos[position_ids].unsqueeze(unsqueeze_dim)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1780, in __torch_function__
    return func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1431, in _dispatch_impl
    op_impl_out = op_impl(self, func, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_impls.py", line 150, in dispatch_to_op_implementations_dict
    return op_implementations_dict[func](fake_mode, func, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_impls.py", line 460, in index_tensor
    return out.to(out_device)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1246, in _dispatch_impl
    flat_args, args_spec = pytree.tree_flatten((args, kwargs))
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 807, in tree_flatten
    spec = _tree_flatten_helper(tree, leaves, is_leaf=is_leaf)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 792, in _tree_flatten_helper
    children_specs = [
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 793, in <listcomp>
    _tree_flatten_helper(child, leaves, is_leaf=is_leaf) for child in child_pytrees
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 792, in _tree_flatten_helper
    children_specs = [
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 793, in <listcomp>
    _tree_flatten_helper(child, leaves, is_leaf=is_leaf) for child in child_pytrees
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 783, in _tree_flatten_helper
    if _is_leaf(tree, is_leaf=is_leaf):
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 609, in _is_leaf
    return (is_leaf is not None and is_leaf(tree)) or _get_node_type(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 602, in _get_node_type
    if _is_namedtuple_instance(tree):
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 591, in _is_namedtuple_instance
    typ = type(tree)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 340, in <module>
    train(DEVICE=args.device,
  File "/home/atticus/maheep/SAE_vs_DAS/main.py", line 116, in train
    logits, _ = new_model(text, temperature=temprature)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/atticus/maheep/SAE_vs_DAS/model.py", line 136, in forward
    with self.model.trace(text) as tracer:
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 196, in trace
    runner.invoke(*inputs, **invoker_args).__enter__()
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/contexts/Invoker.py", line 69, in __enter__
    self.tracer._model._execute(
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/mixins/Generation.py", line 21, in _execute
    return self._execute_forward(prepared_inputs, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 281, in _execute_forward
    return self._model(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 1034, in forward
    outputs = self.gpt_neox(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 925, in forward
    outputs = layer(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 690, in forward
    attention_layer_outputs = self.attention(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1582, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 200, in forward
    query, key = apply_rotary_pos_emb(query_rot, key_rot, cos, sin, position_ids)
  File "/home/atticus/.local/lib/python3.10/site-packages/transformers/models/gpt_neox/modeling_gpt_neox.py", line 642, in apply_rotary_pos_emb
    cos = cos[position_ids].unsqueeze(unsqueeze_dim)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1780, in __torch_function__
    return func(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1431, in _dispatch_impl
    op_impl_out = op_impl(self, func, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_impls.py", line 150, in dispatch_to_op_implementations_dict
    return op_implementations_dict[func](fake_mode, func, *args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_impls.py", line 460, in index_tensor
    return out.to(out_device)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_stats.py", line 20, in wrapper
    return fn(*args, **kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 896, in __torch_dispatch__
    return self.dispatch(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1241, in dispatch
    return self._cached_dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 974, in _cached_dispatch_impl
    output = self._dispatch_impl(func, types, args, kwargs)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/_subclasses/fake_tensor.py", line 1246, in _dispatch_impl
    flat_args, args_spec = pytree.tree_flatten((args, kwargs))
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 807, in tree_flatten
    spec = _tree_flatten_helper(tree, leaves, is_leaf=is_leaf)
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 792, in _tree_flatten_helper
    children_specs = [
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 793, in <listcomp>
    _tree_flatten_helper(child, leaves, is_leaf=is_leaf) for child in child_pytrees
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 792, in _tree_flatten_helper
    children_specs = [
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 793, in <listcomp>
    _tree_flatten_helper(child, leaves, is_leaf=is_leaf) for child in child_pytrees
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 783, in _tree_flatten_helper
    if _is_leaf(tree, is_leaf=is_leaf):
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 609, in _is_leaf
    return (is_leaf is not None and is_leaf(tree)) or _get_node_type(
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 602, in _get_node_type
    if _is_namedtuple_instance(tree):
  File "/home/atticus/.local/lib/python3.10/site-packages/torch/utils/_pytree.py", line 591, in _is_namedtuple_instance
    typ = type(tree)
KeyboardInterrupt