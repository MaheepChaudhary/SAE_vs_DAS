
passed dict emned path /Users/maheepchaudhary/pytorch/Projects/concept_eraser_research/DAS_MAT/baulab.us/u/smarks/autoencoders/pythia-70m-deduped/embed
/Users/maheepchaudhary/miniforge3/envs/nnsight/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
  0%|                                                                                                                                        | 0/1000 [00:00<?, ?it/s]You're using a GPTNeoXTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Epoch: 0, Loss: 0.0
  2%|██▏                                                                                                                            | 17/1000 [00:02<02:03,  7.99it/s]
Epoch: 0, Loss: 50.01250991821289

  3%|███▊                                                                                                                           | 30/1000 [00:04<02:35,  6.26it/s]

  5%|█████▉                                                                                                                         | 47/1000 [00:06<01:52,  8.46it/s]
Epoch: 0, Loss: 68.8369333267212

  6%|███████▋                                                                                                                       | 61/1000 [00:08<01:46,  8.80it/s]

  7%|█████████▍                                                                                                                     | 74/1000 [00:10<02:04,  7.44it/s]

  9%|███████████                                                                                                                    | 87/1000 [00:12<02:47,  5.46it/s]

 10%|████████████▍                                                                                                                  | 98/1000 [00:14<03:19,  4.51it/s]
Epoch: 0, Loss: 25.658617985248565

 11%|██████████████                                                                                                                | 112/1000 [00:16<02:07,  6.96it/s]

 12%|███████████████▊                                                                                                              | 125/1000 [00:18<02:10,  6.70it/s]
Epoch: 0, Loss: 31.267325592041015

 14%|█████████████████▊                                                                                                            | 141/1000 [00:20<02:07,  6.72it/s]

 15%|███████████████████▍                                                                                                          | 154/1000 [00:22<02:26,  5.78it/s]
Epoch: 0, Loss: 74.8423843383789

 17%|█████████████████████▍                                                                                                        | 170/1000 [00:24<01:34,  8.82it/s]
Epoch: 0, Loss: 46.77174639701843

 19%|████████████████████████▍                                                                                                     | 194/1000 [00:26<00:55, 14.46it/s]
Epoch: 0, Loss: 67.15990905761718

 21%|██████████████████████████▍                                                                                                   | 210/1000 [00:28<01:31,  8.66it/s]

 22%|████████████████████████████▏                                                                                                 | 224/1000 [00:30<02:08,  6.02it/s]

 24%|█████████████████████████████▉                                                                                                | 238/1000 [00:32<01:26,  8.82it/s]
Epoch: 0, Loss: 46.743124389648436
Epoch: 0, Loss: 60.220336246490476

 26%|█████████████████████████████████                                                                                             | 262/1000 [00:34<00:59, 12.36it/s]
Epoch: 0, Loss: 48.31299934387207

 29%|████████████████████████████████████                                                                                          | 286/1000 [00:36<01:00, 11.88it/s]
Epoch: 0, Loss: 4.692245197296143

 31%|██████████████████████████████████████▌                                                                                       | 306/1000 [00:38<01:31,  7.57it/s]
Epoch: 0, Loss: 38.666355321928606

 32%|████████████████████████████████████████▌                                                                                     | 322/1000 [00:40<02:03,  5.50it/s]
Epoch: 0, Loss: 40.856285858154294

 34%|██████████████████████████████████████████▉                                                                                   | 341/1000 [00:42<01:15,  8.69it/s]
Epoch: 0, Loss: 60.162444572150704

 37%|██████████████████████████████████████████████▍                                                                               | 369/1000 [00:44<00:39, 16.17it/s]
Epoch: 0, Loss: 46.706800842285155

 39%|████████████████████████████████████████████████▊                                                                             | 387/1000 [00:46<01:09,  8.85it/s]
Epoch: 0, Loss: 126.06379013061523
Epoch: 0, Loss: 58.57060928344727

 42%|████████████████████████████████████████████████████▎                                                                         | 415/1000 [00:48<00:42, 13.73it/s]
Epoch: 0, Loss: 47.62150268554687
Epoch: 0, Loss: 24.914735412597658

 44%|███████████████████████████████████████████████████████▊                                                                      | 443/1000 [00:50<00:36, 15.31it/s]
Epoch: 0, Loss: 40.06775243878364

 46%|██████████████████████████████████████████████████████████                                                                    | 461/1000 [00:52<01:04,  8.31it/s]
Epoch: 0, Loss: 75.68947286605835

 48%|████████████████████████████████████████████████████████████▌                                                                 | 481/1000 [00:54<00:39, 13.07it/s]
Epoch: 0, Loss: 35.68930606842041

 50%|███████████████████████████████████████████████████████████████▏                                                              | 501/1000 [00:56<00:32, 15.22it/s]
Epoch: 0, Loss: 12.808231556415558

 52%|█████████████████████████████████████████████████████████████████▍                                                            | 519/1000 [00:58<00:41, 11.66it/s]
Epoch: 0, Loss: 83.44714279174805
Epoch: 0, Loss: 80.61846809387207

 55%|█████████████████████████████████████████████████████████████████████▏                                                        | 549/1000 [01:00<00:27, 16.35it/s]
Epoch: 0, Loss: 60.17592332106142

 57%|███████████████████████████████████████████████████████████████████████▊                                                      | 570/1000 [01:02<00:28, 15.09it/s]
Epoch: 0, Loss: 30.264571380615234

 59%|██████████████████████████████████████████████████████████████████████████▌                                                   | 592/1000 [01:04<00:35, 11.46it/s]
Epoch: 0, Loss: 50.41476593017578

 61%|████████████████████████████████████████████████████████████████████████████▉                                                 | 611/1000 [01:06<00:33, 11.53it/s]

 63%|███████████████████████████████████████████████████████████████████████████████▏                                              | 628/1000 [01:08<00:45,  8.22it/s]
Epoch: 0, Loss: 97.60740065574646

 65%|█████████████████████████████████████████████████████████████████████████████████▍                                            | 646/1000 [01:10<00:26, 13.13it/s]
Epoch: 0, Loss: 89.25366554260253

 66%|███████████████████████████████████████████████████████████████████████████████████▋                                          | 664/1000 [01:12<00:39,  8.44it/s]
Epoch: 0, Loss: 59.0307975769043

 68%|█████████████████████████████████████████████████████████████████████████████████████▊                                        | 681/1000 [01:14<00:49,  6.47it/s]

 69%|███████████████████████████████████████████████████████████████████████████████████████▍                                      | 694/1000 [01:16<00:49,  6.14it/s]
Epoch: 0, Loss: 91.62592716217041

 72%|██████████████████████████████████████████████████████████████████████████████████████████▍                                   | 718/1000 [01:18<00:23, 12.09it/s]
Epoch: 0, Loss: 55.160586738586424
Epoch: 0, Loss: 86.16109828948974

 74%|█████████████████████████████████████████████████████████████████████████████████████████████▍                                | 742/1000 [01:20<00:24, 10.54it/s]


 78%|██████████████████████████████████████████████████████████████████████████████████████████████████                            | 778/1000 [01:24<00:25,  8.72it/s]
Epoch: 0, Loss: 50.295240211486814

 79%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 793/1000 [01:26<00:23,  8.88it/s]
Epoch: 0, Loss: 51.594125573495695

 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████                        | 810/1000 [01:28<00:19,  9.91it/s]
Epoch: 0, Loss: 26.47659034729004

 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 836/1000 [01:30<00:12, 12.62it/s]
Epoch: 0, Loss: 34.53745040893555
Epoch: 0, Loss: 63.53734245300293
Epoch: 0, Loss: 8.909088134765625
Epoch: 0, Loss: 60.519460678100586
Epoch: 0, Loss: 34.50609302520752


 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 896/1000 [01:34<00:06, 16.23it/s]
Epoch: 0, Loss: 20.558213806152345
Epoch: 0, Loss: 102.38137588500976
Epoch: 0, Loss: 8.291332244873047
Epoch: 0, Loss: 89.6992576599121

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 924/1000 [01:36<00:04, 16.27it/s]
Epoch: 0, Loss: 44.986920547485354


 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 982/1000 [01:40<00:01, 16.52it/s]
Epoch: 0, Loss: 17.376630413532258
Epoch: 0, Loss: 86.05901336669922
Epoch: 0, Loss: 42.61893846988678
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [01:42<00:00,  9.78it/s]
Traceback (most recent call last):
  File "/Users/maheepchaudhary/pytorch/Projects/SAE_vs_DAS/main.py", line 256, in <module>
    train(DEVICE=args.device,
  File "/Users/maheepchaudhary/pytorch/Projects/SAE_vs_DAS/main.py", line 107, in train
    t.save(new_model, f"saved_models/{evaluation}-{residual_layer}-{method}_b{batch_size_train}_e{epochs}.pth")
  File "/Users/maheepchaudhary/miniforge3/envs/nnsight/lib/python3.12/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/Users/maheepchaudhary/miniforge3/envs/nnsight/lib/python3.12/site-packages/torch/serialization.py", line 840, in _save
    pickler.dump(obj)
  File "/Users/maheepchaudhary/miniforge3/envs/nnsight/lib/python3.12/site-packages/torch/nn/utils/parametrize.py", line 305, in getstate
    raise RuntimeError(
RuntimeError: Serialization of parametrized modules is only supported through state_dict(). See:
https://pytorch.org/tutorials/beginner/saving_loading_models.html#saving-loading-a-general-checkpoint-for-inference-and-or-resuming-training
Epoch: 0, Loss: 92.2372591972351
Epoch: 0, Loss: 25.989410877227783